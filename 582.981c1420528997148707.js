"use strict";(self.webpackChunkprism_health_lab=self.webpackChunkprism_health_lab||[]).push([[582],{3582:(tt,b,l)=>{l.r(b),l.d(b,{UsersModule:()=>et});var u=l(8583),a=l(665),T=l(5566),C=l(7736),m=l(3633),v=l(4330),F=l(5301),y=l(5319),w=l(6278),g=l(107),d=l(2340),e=l(7716),h=l(5830),x=l(9344),p=l(1819);function I(o,s){1&o&&(e.TgZ(0,"div",7),e._uU(1," Please provide first name "),e.qZA())}function q(o,s){1&o&&(e.TgZ(0,"div",7),e._uU(1," First name must be of less than 60 characters "),e.qZA())}function P(o,s){1&o&&(e.TgZ(0,"div",7),e._uU(1," Avoid white spaces "),e.qZA())}function N(o,s){if(1&o&&(e.ynx(0),e.YNc(1,I,2,0,"div",23),e.YNc(2,q,2,0,"div",23),e.YNc(3,P,2,0,"div",23),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userProfileForm.controls.first_name.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.userProfileForm.controls.first_name.hasError("maxlength")),e.xp6(1),e.Q6J("ngIf",t.userProfileForm.controls.first_name.hasError("whitespace"))}}function S(o,s){1&o&&(e.TgZ(0,"div",7),e._uU(1," Please provide first name "),e.qZA())}function J(o,s){1&o&&(e.TgZ(0,"div",7),e._uU(1," Last name must be of less than 60 characters "),e.qZA())}function k(o,s){1&o&&(e.TgZ(0,"div",7),e._uU(1," Avoid white spaces "),e.qZA())}function Q(o,s){if(1&o&&(e.ynx(0),e.YNc(1,S,2,0,"div",23),e.YNc(2,J,2,0,"div",23),e.YNc(3,k,2,0,"div",23),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userProfileForm.controls.last_name.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.userProfileForm.controls.last_name.hasError("maxlength")),e.xp6(1),e.Q6J("ngIf",t.userProfileForm.controls.last_name.hasError("whitespace"))}}function M(o,s){1&o&&(e.TgZ(0,"span",7),e._uU(1," Please provide email "),e.qZA())}function O(o,s){1&o&&(e.TgZ(0,"span",7),e._uU(1," Please provide valid email "),e.qZA())}function L(o,s){if(1&o&&(e.ynx(0),e.YNc(1,M,2,0,"span",23),e.YNc(2,O,2,0,"span",23),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userProfileForm.controls.email.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.userProfileForm.controls.email.hasError("pattern"))}}function Y(o,s){1&o&&(e.TgZ(0,"div",7),e._uU(1," Please provide phone number "),e.qZA())}function E(o,s){1&o&&(e.TgZ(0,"div",7),e._uU(1," Phone no must be of 8 digits "),e.qZA())}function D(o,s){1&o&&(e.TgZ(0,"div",7),e._uU(1," Avoid white spaces "),e.qZA())}function B(o,s){1&o&&(e.TgZ(0,"div",7),e._uU(1," Phone must be numeric "),e.qZA())}function $(o,s){if(1&o&&(e.ynx(0),e.YNc(1,Y,2,0,"div",23),e.YNc(2,E,2,0,"div",23),e.YNc(3,D,2,0,"div",23),e.YNc(4,B,2,0,"div",23),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userProfileForm.controls.phone.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.userProfileForm.controls.phone.hasError("minlength")),e.xp6(1),e.Q6J("ngIf",t.userProfileForm.controls.phone.hasError("whitespace")),e.xp6(1),e.Q6J("ngIf",t.userProfileForm.controls.phone.hasError("phoneonly"))}}function R(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(){return e.CHM(t),e.oxw().chooseImage()}),e._uU(1,"Upload Image "),e.qZA()}}function j(o,s){1&o&&(e.TgZ(0,"div",7),e._uU(1,"Profile picture must be uploaded"),e.qZA())}function z(o,s){1&o&&e._UZ(0,"img",40)}function G(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",41),e.NdJ("click",function(){return e.CHM(t),e.oxw().onSubmit()}),e._UZ(1,"i",42),e._uU(2," Update "),e.qZA()}if(2&o){const t=e.oxw();e.ekj("disabled",!t.userProfileForm.valid)}}let H=(()=>{class o{constructor(t,n,i,r){this.location=t,this.modal=n,this.apiService=i,this.toastrService=r,this.userSubscription$=new y.w,this.submitted=!1,this.isSuperAdmin=!1,this.imageLoading=!1,this.userProfileForm=new a.cw({id:new a.NI(null),first_name:new a.NI(null,[a.kI.required,a.kI.maxLength(60),g.d.noWhiteSpace]),last_name:new a.NI(null,[a.kI.required,a.kI.maxLength(60),g.d.noWhiteSpace]),email:new a.NI(null,[a.kI.required,a.kI.pattern("^[a-zA-Z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$")]),phone:new a.NI(null,[a.kI.required,a.kI.minLength(8),g.d.noWhiteSpace,g.d.phoneOnly]),designation:new a.NI(null),department:new a.NI(null),user_picture:new a.NI(null),status:new a.NI("Active"),group:new a.NI(null)}),this.userProfileData=null}ngOnInit(){var t;this.getUser(),this.userSubscription$=null===(t=null==localStorage?void 0:localStorage.changes)||void 0===t?void 0:t.subscribe(n=>{setTimeout(()=>{this.getUser()},1e3),this.userSubscription$&&this.userSubscription$.unsubscribe()})}getUser(){this.apiService.get(`${d.N.userms}/users/get-current-user`).subscribe(n=>{const i=n.data.data;this.userProfileData=n.data.data,this.userProfileForm.patchValue(i),this.userProfileForm.controls.group.setValue(i.selected_groups),this.isSuperAdmin="SA"===i.type,this.selectedImage=i.user_picture})}chooseImage(){var t;null===(t=document.getElementById("fileInput"))||void 0===t||t.click()}onImageChanged(t){var n,i;this.imageLoading=!0,i=t.target.files[0],null===(n=this.userProfileForm.get("user_picture"))||void 0===n||n.setValue(i),this.readImageURL(t.target)}readImageURL(t){if(t.files&&t.files[0]){var n=new FileReader;n.onload=i=>{this.selectedImage=null==i?void 0:i.target.result},this.imageLoading=!1,n.readAsDataURL(t.files[0])}}onSubmit(){if(this.submitted=!0,!this.userProfileForm.valid)return;const t=`${d.N.userms}/users/`,n=this.userProfileForm.value;let i={id:n.id,first_name:n.first_name,last_name:n.last_name,email:n.email,phone:n.phone,user_picture:n.user_picture,status:n.status,department:n.department,designation:n.designation,is_change_password:n.is_change_password,group_list:[]};null!=(null==n?void 0:n.group)?null==n||n.group.forEach(_=>{i.group_list.push(_.id)}):i.group_list=null;let r=i.user_picture;(null==r||"string"==typeof r&&r.includes("https"))&&delete i.user_picture;let c=this.convertToFormData(i);this.updateUser(t,c)}convertToFormData(t){let n=new FormData;for(var i in t)n.append(i,t[i]);return n}updateUser(t,n){this.apiService.patch(t,n).subscribe(i=>{this.toastrService.success(i.message,"Success",{progressBar:!0,progressAnimation:"decreasing",timeOut:3e3}),this.getUser();var r=localStorage.getItem("user");(r=JSON.parse(r)).department=this.userProfileData.department,r.designation=this.userProfileData.designation,r.email=this.userProfileData.email,r.name=this.userProfileData.name,r.user_picture=this.userProfileData.user_picture,r.first_name=this.userProfileData.first_name,r.last_name=this.userProfileData.last_name,r.phone=this.userProfileData.phone,localStorage.setItem("user",JSON.stringify(r))},i=>{this.toastrService.error(i.error.message,"Error")})}openResetModal(){var t;const n=this.modal.open(w.p,{size:"md",scrollable:!0});n.componentInstance.fromProfile=!0,n.componentInstance.email=null===(t=this.userProfileForm.get("email"))||void 0===t?void 0:t.value}onBack(){this.location.back()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.Ye),e.Y36(m.FF),e.Y36(h.s),e.Y36(x._W))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-user-profile"]],decls:86,vars:19,consts:[[1,"card","w-100-p","p-20",2,"border","none"],[1,"fs-14","fw-600","pt-10","pb-10","mb-0",2,"border-bottom","1px solid #ececec"],["fxLayout","row wrap",1,"pt-16","w-100-p",2,"height","calc(100% - 40px)"],["fxLayout","row","fxLayoutAlign","space-between start",1,"w-100-p","pr-16"],["fxFlex","","fxLayout","row wrap","fxLayoutAlign","space-between start",3,"formGroup","ngSubmit"],["fxFlex","48.5"],[1,"form-group","margin-bottom-10"],[1,"text-danger"],["type","text","formControlName","first_name","placeholder","First Name",1,"form-control",3,"readonly"],[4,"ngIf"],["fxFlex","48.5",1,"mr-0"],["type","text","formControlName","last_name","placeholder","Last Name",1,"form-control",3,"readonly"],["type","email","formControlName","email","placeholder","Email",1,"form-control",3,"readonly"],[1,"input-group"],["for","ph",1,"input-group-text",2,"border-right","none"],["type","text","autocomplete","off","id","ph","maxlength","8","formControlName","phone","placeholder","Phone Number",1,"form-control",3,"readonly"],["type","text","formControlName","designation","value","","placeholder","Designation",1,"form-control",3,"readonly"],["type","text","formControlName","department","value","","placeholder","Department",1,"form-control",3,"readonly"],["fxFlex","25","fxLayoutAlign","center start",1,"col-lg-12","p-0"],["fxLayout","column",1,"form-group","text-center"],["width","150px","height","150px",1,"img-bordered",2,"border-radius","2%","position","relative",3,"src"],["type","file","id","fileInput","accept",".jpg, .png, .jpeg",2,"display","none",3,"change"],["type","button","class","btn btn-primary w-150","style","margin-top: 14px; margin-bottom: 10px;",3,"click",4,"ngIf"],["class","text-danger",4,"ngIf"],["src","/assets/images/new-loader.gif","alt","Loader","width","60px","height","60px","style","position: absolute; top: 25%; left: 40%;",4,"ngIf"],["fxFlex","100"],["fxFlex","100","fxLayout","row wrap"],[1,"w-100-p"],["fxFlex","75","fxLayoutAlign","space-between start","fxLayoutGap","24px","fxLayout","row",3,"formGroup"],["fxFlex",""],["type","email","formControlName","email","value","","placeholder","Email",1,"form-control",3,"readonly"],[1,"input-group","margin-bottom-10"],["type","password","id","pw","value","123456","placeholder","password",1,"form-control",3,"readonly"],["for","pw",1,"input-group-text",3,"click"],[1,"ri-rotate-lock-fill"],["fxFlex","100",1,"form-group","text-center","mb-0"],["type","submit","class","btn btn-success btn-round mr-8",3,"disabled","click",4,"ngIf"],[1,"btn","btn-default","btn-round",3,"click"],[1,"ri-arrow-go-back-line"],["type","button",1,"btn","btn-primary","w-150",2,"margin-top","14px","margin-bottom","10px",3,"click"],["src","/assets/images/new-loader.gif","alt","Loader","width","60px","height","60px",2,"position","absolute","top","25%","left","40%"],["type","submit",1,"btn","btn-success","btn-round","mr-8",3,"click"],[1,"ri-check-fill"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"h3",1),e._uU(2,"My Profile"),e.qZA(),e.TgZ(3,"div",2),e.TgZ(4,"div",3),e.TgZ(5,"form",4),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.TgZ(6,"div",5),e.TgZ(7,"div",6),e.TgZ(8,"label"),e._uU(9,"First Name"),e.TgZ(10,"span",7),e._uU(11,"*"),e.qZA(),e.qZA(),e._UZ(12,"input",8),e.YNc(13,N,4,3,"ng-container",9),e.qZA(),e.qZA(),e.TgZ(14,"div",10),e.TgZ(15,"div",6),e.TgZ(16,"label"),e._uU(17,"Last Name"),e.TgZ(18,"span",7),e._uU(19,"*"),e.qZA(),e.qZA(),e._UZ(20,"input",11),e.YNc(21,Q,4,3,"ng-container",9),e.qZA(),e.qZA(),e.TgZ(22,"div",5),e.TgZ(23,"div",6),e.TgZ(24,"label"),e._uU(25,"Email"),e.TgZ(26,"span",7),e._uU(27,"*"),e.qZA(),e.qZA(),e._UZ(28,"input",12),e.YNc(29,L,3,2,"ng-container",9),e.qZA(),e.qZA(),e.TgZ(30,"div",10),e.TgZ(31,"div",6),e.TgZ(32,"label"),e._uU(33,"Phone Number"),e.TgZ(34,"span",7),e._uU(35,"*"),e.qZA(),e.qZA(),e.TgZ(36,"div",13),e.TgZ(37,"span",14),e._uU(38,"974"),e.qZA(),e._UZ(39,"input",15),e.qZA(),e.YNc(40,$,5,4,"ng-container",9),e.qZA(),e.qZA(),e.TgZ(41,"div",10),e.TgZ(42,"div",6),e.TgZ(43,"label"),e._uU(44,"Designation"),e.qZA(),e._UZ(45,"input",16),e.qZA(),e.qZA(),e.TgZ(46,"div",5),e.TgZ(47,"div",6),e.TgZ(48,"label"),e._uU(49,"Department"),e.qZA(),e._UZ(50,"input",17),e.qZA(),e.qZA(),e.qZA(),e.TgZ(51,"div",18),e.TgZ(52,"div",19),e._UZ(53,"img",20),e.TgZ(54,"input",21),e.NdJ("change",function(r){return n.onImageChanged(r)}),e.qZA(),e.YNc(55,R,2,0,"button",22),e.YNc(56,j,2,0,"div",23),e.YNc(57,z,1,0,"img",24),e.qZA(),e.qZA(),e.qZA(),e._UZ(58,"hr",25),e.TgZ(59,"div",26),e.TgZ(60,"h4",27),e._uU(61,"Change Password"),e.qZA(),e.TgZ(62,"form",28),e.TgZ(63,"div",29),e.TgZ(64,"div",6),e.TgZ(65,"label"),e._uU(66,"Email"),e.TgZ(67,"span",7),e._uU(68,"*"),e.qZA(),e.qZA(),e._UZ(69,"input",30),e.qZA(),e.qZA(),e.TgZ(70,"div",29),e.TgZ(71,"div",6),e.TgZ(72,"label"),e._uU(73,"Password"),e.TgZ(74,"span",7),e._uU(75,"*"),e.qZA(),e.qZA(),e.TgZ(76,"div",31),e._UZ(77,"input",32),e.TgZ(78,"span",33),e.NdJ("click",function(){return n.openResetModal()}),e._UZ(79,"i",34),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(80,"hr",25),e.TgZ(81,"div",35),e.YNc(82,G,3,2,"button",36),e.TgZ(83,"button",37),e.NdJ("click",function(){return n.onBack()}),e._UZ(84,"i",38),e._uU(85," Back "),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.Q6J("formGroup",n.userProfileForm),e.xp6(7),e.Q6J("readonly",!n.isSuperAdmin),e.xp6(1),e.Q6J("ngIf",n.isSuperAdmin&&n.userProfileForm.controls.first_name.dirty),e.xp6(7),e.Q6J("readonly",!n.isSuperAdmin),e.xp6(1),e.Q6J("ngIf",n.isSuperAdmin&&n.userProfileForm.controls.last_name.dirty),e.xp6(7),e.Q6J("readonly",!n.isSuperAdmin),e.xp6(1),e.Q6J("ngIf",n.isSuperAdmin&&n.userProfileForm.controls.email.dirty),e.xp6(10),e.Q6J("readonly",!n.isSuperAdmin),e.xp6(1),e.Q6J("ngIf",n.isSuperAdmin&&n.userProfileForm.controls.phone.dirty),e.xp6(5),e.Q6J("readonly",!n.isSuperAdmin),e.xp6(5),e.Q6J("readonly",!n.isSuperAdmin),e.xp6(3),e.Q6J("src",n.selectedImage?n.selectedImage:"assets/images/default_user.png",e.LSH),e.xp6(2),e.Q6J("ngIf",n.isSuperAdmin),e.xp6(1),e.Q6J("ngIf",!n.selectedImage),e.xp6(1),e.Q6J("ngIf",n.imageLoading),e.xp6(5),e.Q6J("formGroup",n.userProfileForm),e.xp6(7),e.Q6J("readonly",!n.isSuperAdmin),e.xp6(8),e.Q6J("readonly",!n.isSuperAdmin),e.xp6(5),e.Q6J("ngIf",n.isSuperAdmin))},directives:[p.xw,p.Wh,a._Y,a.JL,p.yH,a.sg,a.Fj,a.JJ,a.u,u.O5,a.nD,p.SQ],styles:[".group-container .ng-select-container{box-shadow:none;border-radius:0!important}"]}),o})();var W=l(799),U=l(5174),V=l(946);function X(o,s){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",13),e.NdJ("click",function(){const i=e.CHM(t),r=i.$implicit,c=i.index;return e.oxw().onSelectSource(r,c,r.id)}),e._uU(2),e.qZA(),e.BQk()}if(2&o){const t=s.$implicit,n=s.index,i=e.oxw();e.xp6(1),e.ekj("selected-item",null==i.source[n]?null:i.source[n].selected),e.xp6(1),e.hij(" ",t.name,"")}}function K(o,s){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",13),e.NdJ("click",function(){const i=e.CHM(t),r=i.$implicit,c=i.index;return e.oxw().onSelectDestination(r,c,r.id)}),e._uU(2),e.qZA(),e.BQk()}if(2&o){const t=s.$implicit,n=s.index,i=e.oxw();e.xp6(1),e.ekj("selected-item",null==i.destination[n]?null:i.destination[n].selected),e.xp6(1),e.hij(" ",t.name,"")}}let ee=(()=>{class o{constructor(){this.sourceSelected=!1,this.destinationSelected=!1,this.disabled=!1,this.source=[],this.destination=[],this.default=[],this.selected=[],this.lastMove=[],this.lastMove2=[],this.defaultSource=[],this.signal=new e.vpe}ngOnInit(){}setDefault(){this.default.length>0&&(this.destination=this.default),this.destination.length>0&&this.destination.forEach(t=>{t.selected=!1;let n=this.source.findIndex(i=>i.id===t.id);this.source.splice(n,1)}),setTimeout(()=>{this.signal.emit(this.destination)},100)}reload(){this.signal.emit({type:"reload"})}onSelectSource(t,n,i){if(this.source[n].selected=!this.source[n].selected,this.source.forEach(r=>{r.selected&&(this.sourceSelected=!0)}),this.source[n].selected)this.selected.push(this.source[n]);else{let r=this.selected.findIndex(c=>c.id===t.id);this.selected.splice(r,1)}}onSelectDestination(t,n,i){if(this.destination[n].selected=!this.destination[n].selected,this.destinationSelected=!!this.destination[n].selected,this.destination[n].selected)this.selected.push(this.destination[n]);else{let r=this.selected.findIndex(c=>c.id===t.id);this.selected.splice(r,1)}}addSelected(){this.selected.forEach(t=>{this.destination.push(t),this.lastMove.push(t),t.selected=!1,this.sourceSelected=!1;let n=this.source.findIndex(i=>t.id===i.id);-1!==n&&this.source.splice(n,1)}),this.selected=[],this.signal.emit(this.destination)}addAll(){this.source.forEach(t=>{this.destination.push(t),this.lastMove.push(t)}),this.source=[],this.signal.emit(this.destination)}removeSelected(){this.selected.forEach(t=>{this.source.push(t),this.lastMove2.push(t),t.selected=!1,this.destinationSelected=!1;let n=this.destination.findIndex(i=>t.id===i.id);-1!==n&&this.destination.splice(n,1)}),this.selected=[],this.signal.emit(this.destination)}removeAll(){this.destination.forEach(t=>{this.source.push(t),this.lastMove2.push(t)}),this.destination=[],this.signal.emit(this.destination)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-dual-list"]],inputs:{source:"source",destination:"destination",default:"default",disabled:"disabled",defaultSource:"defaultSource"},outputs:{signal:"signal"},decls:25,vars:12,consts:[["fxLayout","row","fxLayoutGap","8px","fxLayoutAlign","space-between center",1,"card","h-140","w-100-p",2,"border","none"],["fxFlex","45","fxLayout","column",1,"card",2,"height","100%","overflow","auto"],[4,"ngFor","ngForOf"],["fxLayoutAlign","center center","fxLayout","column","fxLayoutGap","4px"],[1,"btn","btn-icon","p-0","list-btn",3,"click"],["ngbTooltip","Restore",1,"material-icons"],["ngbTooltip","Add All",1,"material-icons"],["ngbTooltip","Add All",1,"material-icons",2,"margin-left","-18px"],["ngbTooltip","Add Selected",1,"material-icons"],["ngbTooltip","Unselect",1,"material-icons"],["ngbTooltip","Unselect All",1,"material-icons"],["ngbTooltip","Unselect All",1,"material-icons",2,"margin-left","-18px"],["fxFlex","45",1,"card",2,"height","100%","overflow","auto"],[1,"item",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,X,3,3,"ng-container",2),e.qZA(),e.TgZ(3,"div",3),e.TgZ(4,"a",4),e.NdJ("click",function(){return n.reload()}),e.TgZ(5,"span",5),e._uU(6," restore "),e.qZA(),e.qZA(),e.TgZ(7,"a",4),e.NdJ("click",function(){return n.addAll()}),e.TgZ(8,"span",6),e._uU(9," chevron_right "),e.qZA(),e.TgZ(10,"span",7),e._uU(11," chevron_right "),e.qZA(),e.qZA(),e.TgZ(12,"a",4),e.NdJ("click",function(){return n.addSelected()}),e.TgZ(13,"span",8),e._uU(14," chevron_right "),e.qZA(),e.qZA(),e.TgZ(15,"a",4),e.NdJ("click",function(){return n.removeSelected()}),e.TgZ(16,"span",9),e._uU(17," chevron_left "),e.qZA(),e.qZA(),e.TgZ(18,"a",4),e.NdJ("click",function(){return n.removeAll()}),e.TgZ(19,"span",10),e._uU(20," chevron_left "),e.qZA(),e.TgZ(21,"span",11),e._uU(22," chevron_left "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(23,"div",12),e.YNc(24,K,3,3,"ng-container",2),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngForOf",n.source),e.xp6(2),e.ekj("disabled",n.disabled),e.xp6(3),e.ekj("disabled",0===(null==n.source?null:n.source.length)||n.disabled),e.xp6(5),e.ekj("disabled",!n.sourceSelected||n.disabled),e.xp6(3),e.ekj("disabled",!n.destinationSelected||n.disabled),e.xp6(3),e.ekj("disabled",0===(null==n.destination?null:n.destination.length)||n.disabled),e.xp6(6),e.Q6J("ngForOf",n.destination))},directives:[p.xw,p.SQ,p.Wh,p.yH,u.sg,m._L],styles:[".item[_ngcontent-%COMP%]{padding:4px;font-size:14px;height:30px;line-height:20px;border:1px solid #ddd;border-top:transparent}.item[_ngcontent-%COMP%]:hover{background:#f5f5f5;cursor:pointer}.selected-item[_ngcontent-%COMP%]{background:#d9edf7}.selected-item[_ngcontent-%COMP%]:hover{background:#d9edf7}.list-btn[_ngcontent-%COMP%]{height:24px;width:36px;border-color:#f5f5f5}"]}),o})();var Z=l(4272);function te(o,s){1&o&&e._UZ(0,"img",38)}function ne(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," Please provide first name "),e.qZA())}function oe(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," First name must be of less than 60 characters "),e.qZA())}function ie(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," Avoid white spaces "),e.qZA())}function se(o,s){if(1&o&&(e.ynx(0),e.YNc(1,ne,2,0,"span",15),e.YNc(2,oe,2,0,"span",15),e.YNc(3,ie,2,0,"span",15),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.first_name.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.first_name.hasError("maxlength")),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.first_name.hasError("whitespace"))}}function re(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," Please provide last name "),e.qZA())}function ae(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," Last name must be of less than 60 characters "),e.qZA())}function le(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," Avoid white spaces "),e.qZA())}function ce(o,s){if(1&o&&(e.ynx(0),e.YNc(1,re,2,0,"span",15),e.YNc(2,ae,2,0,"span",15),e.YNc(3,le,2,0,"span",15),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.last_name.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.last_name.hasError("maxlength")),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.last_name.hasError("whitespace"))}}function pe(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," Please provide department "),e.qZA())}function de(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," Please provide designation"),e.qZA())}function ue(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," Please provide email "),e.qZA())}function ge(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," Please provide valid email "),e.qZA())}function me(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," Avoid white spaces "),e.qZA())}function _e(o,s){if(1&o&&(e.ynx(0),e.YNc(1,ue,2,0,"span",15),e.YNc(2,ge,2,0,"span",15),e.YNc(3,me,2,0,"span",15),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.email.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.email.getError("pattern")),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.email.getError("whitespace"))}}function fe(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," Please provide phone number "),e.qZA())}function he(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," Phone no must be of 8 digits "),e.qZA())}function xe(o,s){1&o&&(e.TgZ(0,"div",9),e._uU(1," Phone no must be numeric "),e.qZA())}function Ze(o,s){if(1&o&&(e.ynx(0),e.YNc(1,fe,2,0,"span",15),e.YNc(2,he,2,0,"span",15),e.YNc(3,xe,2,0,"div",15),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.phone.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.phone.hasError("minlength")),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.phone.hasError("phoneonly"))}}function be(o,s){if(1&o&&(e.TgZ(0,"div",39),e._UZ(1,"input",40),e.TgZ(2,"label",41),e._uU(3,"Reset Password upon First Login"),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("readonly","detail"===t.action)}}function Te(o,s){if(1&o&&(e.TgZ(0,"ng-select",45),e.TgZ(1,"ng-option",46),e._uU(2,"Active"),e.qZA(),e.TgZ(3,"ng-option",47),e._uU(4,"InActive"),e.qZA(),e.qZA()),2&o){const t=e.oxw(2);e.Q6J("readonly",t.userLoggedIn)("clearable",!1)}}function ve(o,s){1&o&&e._UZ(0,"input",48)}function Ue(o,s){if(1&o&&(e.TgZ(0,"div",42),e.TgZ(1,"label"),e._uU(2,"Status"),e.qZA(),e.YNc(3,Te,5,2,"ng-select",43),e.YNc(4,ve,1,0,"input",44),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("ngIf","detail"!==t.action),e.xp6(1),e.Q6J("ngIf","detail"===t.action)}}function Ae(o,s){1&o&&(e.TgZ(0,"span",9),e._uU(1," Please provide group "),e.qZA())}function Ce(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().chooseImage()}),e._uU(1," Upload Image "),e.qZA()}}function Fe(o,s){1&o&&(e.TgZ(0,"div",9),e._uU(1,"Profile picture must be uploaded"),e.qZA())}function ye(o,s){1&o&&e._UZ(0,"img",50)}function we(o,s){1&o&&(e.TgZ(0,"span"),e.TgZ(1,"div",51),e._uU(2," Choose image only. "),e.qZA(),e.qZA())}function Ie(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",52),e.NdJ("click",function(){return e.CHM(t),e.oxw().onSubmit()}),e._UZ(1,"i",53),e._uU(2),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",!t.userForm.valid||t.loading||0===t.destination.length||!t.imageToSend),e.xp6(2),e.hij(" ",null!=t.data&&t.data.id?"Update":"Save"," ")}}let A=(()=>{class o{constructor(t,n,i){this.modalRef=t,this.apiService=n,this.toastrService=i,this.submitted=!1,this.imageLoading=!1,this.loading=!1,this.title="Add User",this.action="",this.userForm=new a.cw({first_name:new a.NI(null,[a.kI.required,a.kI.maxLength(60),g.d.noWhiteSpace]),last_name:new a.NI(null,[a.kI.required,a.kI.maxLength(60),g.d.noWhiteSpace]),email:new a.NI(null,[a.kI.required,g.d.noWhiteSpace,a.kI.pattern("^[a-zA-Z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$")]),country_code:new a.NI(974),phone:new a.NI(null,[a.kI.required,a.kI.minLength(8),g.d.phoneOnly]),designation:new a.NI(null),department:new a.NI(null),user_picture:new a.NI(null,[a.kI.required]),status:new a.NI("Active")}),this.data=null,this.source=[],this.destination=[],this.notImage=!1,this.userLoggedIn=!1}ngOnInit(){var t;const n=localStorage.getItem("user"),i=JSON.parse(n);if(this.userLoggedIn=!!i&&!!this.data&&i.id===this.data.id,this.data||(this.userForm.addControl("is_change_password",new a.NI(!1)),this.getGroups()),this.data){if(this.userForm.patchValue(this.data),this.selectedImage=this.data.user_picture,this.imageToSend=this.data.user_picture,this.data.phone){let c=this.data.phone.toString();null===(t=this.userForm.get("phone"))||void 0===t||t.setValue(c.replace("974",""))}this.data.selected_groups&&this.data.selected_groups.length>0?this.data.selected_groups.forEach(r=>{this.destination.push(r)}):this.destination=[],this.data.unselected_groups&&this.data.unselected_groups.length>0?this.data.unselected_groups.forEach(r=>{this.source.push(r)}):this.source=[]}}chooseImage(){var t;null===(t=document.getElementById("fileInput"))||void 0===t||t.click()}onImageChanged(t){var n,i,r;this.imageLoading=!0,console.log("event.target.files= ",t.target.files[0]),t.target.files.length>0&&(-1===(r=t.target.files[0]).type.indexOf("image")?(this.notImage=!0,this.selectedImage=null,this.imageLoading=!1,null===(n=this.userForm.get("user_picture"))||void 0===n||n.setValue(null)):(this.notImage=!1,this.imageToSend=t.target.files[0],null===(i=this.userForm.get("user_picture"))||void 0===i||i.setValue(r),this.readImageURL(t.target)))}readImageURL(t){if(t.files&&t.files[0]){var n=new FileReader;n.onload=i=>{this.selectedImage=null==i?void 0:i.target.result},this.imageLoading=!1,n.readAsDataURL(t.files[0])}}onListSignal(t){"reload"===t.type?(this.destination=[],this.source=[],this.data&&this.data.selected_groups.length>0?this.data.selected_groups.forEach(n=>{this.destination.push(n)}):this.destination=[],this.data&&this.data.unselected_groups.length>0?this.data.unselected_groups.forEach(n=>{this.source.push(n)}):this.destination=[]):this.destination=t}getGroups(){this.apiService.get(`${d.N.userms}/users/get-groups`).subscribe(n=>{this.source=n.data},n=>{this.toastrService.error(n.error.message,"Error",{progressBar:!0,progressAnimation:"decreasing",timeOut:3e3})})}onSubmit(){var t,n;if(this.submitted=!0,!this.userForm.valid||0===this.destination.length||null==this.userForm.value.user_picture)return void(null==this.userForm.value.user_picture&&this.userForm.controls.user_picture.setErrors({incorrect:!0}));const i=`${d.N.userms}/users/`,r=this.userForm.value;let c={first_name:r.first_name,last_name:r.last_name,email:r.email,phone:r.phone,status:r.status,department:r.department,designation:r.designation,is_change_password:r.is_change_password,user_picture:r.user_picture,group_list:[]};if(this.destination.forEach(f=>{c.group_list.push(f.id)}),this.data&&(null===(t=this.data)||void 0===t?void 0:t.id)){c.id=this.data.id;let f=c.user_picture;(null==f||"string"==typeof f&&f.includes("https"))&&delete c.user_picture}let _=this.convertToFormData(c);this.loading=!0,this.data&&(null===(n=this.data)||void 0===n?void 0:n.id)?this.updateUser(i,_):this.createUser(i,_)}convertToFormData(t){new FormData;var i=new FormData;for(var r in t)i.append(r,t[r]);return i}createUser(t,n){this.apiService.post(t,n).subscribe(i=>{this.toastrService.success(i.message,"Success",{progressBar:!0,progressAnimation:"decreasing",timeOut:3e3}),this.onCloseModel()},i=>{this.toastrService.error(i.error.message,"Error creating user",{progressBar:!0,progressAnimation:"decreasing",timeOut:3e3}),this.loading=!1})}updateUser(t,n){this.apiService.patch(t,n).subscribe(i=>{this.toastrService.success(i.message,"Success",{progressBar:!0,progressAnimation:"decreasing",timeOut:3e3}),this.onCloseModel()},i=>{this.toastrService.error(i.error.message,"Error updating user",{progressBar:!0,progressAnimation:"decreasing",timeOut:3e3}),this.loading=!1})}onCloseModel(){this.modalRef.close()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(m.Kz),e.Y36(h.s),e.Y36(x._W))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-user-form"]],decls:81,vars:28,consts:[[1,"modal-header","pt-8","pb-8"],[1,"modal-title","fs-18","fw-300"],["type","button","tabindex","-1",1,"close",3,"click"],["src","/assets/images/block-loader.gif","alt","Loading","class","loading","width","150px","height","150px",4,"ngIf"],["fxLayout","row wrap",1,"modal-body","w-100-p",2,"position","relative"],["fxLayout","row","fxLayoutAlign","space-between start",1,"w-100-p","pl-16","pr-16"],["fxFlex","","fxLayout","row wrap","fxLayoutAlign","space-between start",3,"formGroup","ngSubmit"],["fxFlex","48.5"],[1,"form-group","margin-bottom-10"],[1,"text-danger"],["type","text","formControlName","first_name","placeholder","First Name",1,"form-control",3,"readonly"],[4,"ngIf"],["fxFlex","48.5",1,"mr-0"],["type","text","formControlName","last_name","placeholder","Last Name",1,"form-control",3,"readonly"],["type","text","formControlName","department","placeholder","Department",1,"form-control",3,"readonly"],["class","text-danger",4,"ngIf"],["type","text","formControlName","designation","placeholder","Designation",1,"form-control",3,"readonly"],["type","email","formControlName","email","value","","placeholder","Email",1,"form-control",3,"readonly"],[1,"input-group"],["for","ph",1,"input-group-text",2,"border-right","none"],["type","text","autocomplete","off","id","ph","maxlength","8","formControlName","phone","placeholder","Phone Number",1,"form-control",3,"readonly"],["fxFlex","100","fxLayoutGap","8px","fxLayoutAlign","start center","class","h-40",4,"ngIf"],["fxFlex","100","class","form-group",4,"ngIf"],["fxFlex",""],[1,"form-group"],[3,"source","destination","disabled","signal"],["fxFlex","20","fxLayoutAlign","center start"],["fxFlex","75",1,"col-lg-12","p-0"],["fxLayout","column",1,"form-group","text-center",2,"margin-top","20%","position","relative"],["height","130px",1,"img-bordered",2,"border-radius","2%","position","relative",3,"src"],["type","file","id","fileInput","accept",".jpg, .png, .jpeg",2,"display","none",3,"change"],["type","button","class","btn btn-primary mt-10",3,"click",4,"ngIf"],["src","assets/images/new-loader.gif","alt","loader","width","60px","height","60px","style","position: absolute; top: 20%; left: 25%;",4,"ngIf"],["fxFlex","100"],["fxFlex","100",1,"form-group","text-center","mb-0"],["type","submit","class","btn btn-success btn-round mr-8",3,"disabled","click",4,"ngIf"],[1,"btn","btn-default","btn-round",3,"click"],[1,"ri-close-line"],["src","/assets/images/block-loader.gif","alt","Loading","width","150px","height","150px",1,"loading"],["fxFlex","100","fxLayoutGap","8px","fxLayoutAlign","start center",1,"h-40"],["type","checkbox","formControlName","is_change_password","id","chng-pasword",3,"readonly"],["for","chng-pasword",1,"mb-0"],["fxFlex","100",1,"form-group"],["class","group-container","formControlName","status","style","max-width: 48.5%;",3,"readonly","clearable",4,"ngIf"],["readonly","","type","text","class","form-control","formControlName","status","style","max-width: 48.5%",4,"ngIf"],["formControlName","status",1,"group-container",2,"max-width","48.5%",3,"readonly","clearable"],["value","Active"],["value","InActive"],["readonly","","type","text","formControlName","status",1,"form-control",2,"max-width","48.5%"],["type","button",1,"btn","btn-primary","mt-10",3,"click"],["src","assets/images/new-loader.gif","alt","loader","width","60px","height","60px",2,"position","absolute","top","20%","left","25%"],[1,"alert","alert-warning"],["type","submit",1,"btn","btn-success","btn-round","mr-8",3,"disabled","click"],[1,"ri-check-fill"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"h4",1),e._uU(2),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return n.onCloseModel()}),e._uU(4,"\xd7"),e.qZA(),e.qZA(),e.YNc(5,te,1,0,"img",3),e.TgZ(6,"div",4),e.TgZ(7,"div",5),e.TgZ(8,"form",6),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.TgZ(9,"div",7),e.TgZ(10,"div",8),e.TgZ(11,"label"),e._uU(12,"First Name"),e.TgZ(13,"span",9),e._uU(14,"*"),e.qZA(),e.qZA(),e._UZ(15,"input",10),e.YNc(16,se,4,3,"ng-container",11),e.qZA(),e.qZA(),e.TgZ(17,"div",12),e.TgZ(18,"div",8),e.TgZ(19,"label"),e._uU(20,"Last Name"),e.TgZ(21,"span",9),e._uU(22,"*"),e.qZA(),e.qZA(),e._UZ(23,"input",13),e.YNc(24,ce,4,3,"ng-container",11),e.qZA(),e.qZA(),e.TgZ(25,"div",7),e.TgZ(26,"div",8),e.TgZ(27,"label"),e._uU(28,"Department"),e.qZA(),e._UZ(29,"input",14),e.YNc(30,pe,2,0,"span",15),e.qZA(),e.qZA(),e.TgZ(31,"div",12),e.TgZ(32,"div",8),e.TgZ(33,"label"),e._uU(34,"Designation"),e.qZA(),e._UZ(35,"input",16),e.YNc(36,de,2,0,"span",15),e.qZA(),e.qZA(),e.TgZ(37,"div",7),e.TgZ(38,"div",8),e.TgZ(39,"label"),e._uU(40,"Email"),e.TgZ(41,"span",9),e._uU(42,"*"),e.qZA(),e.qZA(),e._UZ(43,"input",17),e.YNc(44,_e,4,3,"ng-container",11),e.qZA(),e.qZA(),e.TgZ(45,"div",12),e.TgZ(46,"div",8),e.TgZ(47,"label"),e._uU(48,"Phone Number"),e.TgZ(49,"span",9),e._uU(50,"*"),e.qZA(),e.qZA(),e.TgZ(51,"div",18),e.TgZ(52,"span",19),e._uU(53,"974"),e.qZA(),e._UZ(54,"input",20),e.qZA(),e.YNc(55,Ze,4,3,"ng-container",11),e.qZA(),e.qZA(),e.YNc(56,be,4,1,"div",21),e.YNc(57,Ue,5,2,"div",22),e.TgZ(58,"div",23),e.TgZ(59,"div",24),e.TgZ(60,"label"),e._uU(61,"Groups"),e.TgZ(62,"span",9),e._uU(63,"*"),e.qZA(),e.qZA(),e.TgZ(64,"app-dual-list",25),e.NdJ("signal",function(r){return n.onListSignal(r)}),e.qZA(),e.YNc(65,Ae,2,0,"span",15),e.qZA(),e.qZA(),e.qZA(),e.TgZ(66,"div",26),e.TgZ(67,"div",27),e.TgZ(68,"div",28),e._UZ(69,"img",29),e.TgZ(70,"input",30),e.NdJ("change",function(r){return n.onImageChanged(r)}),e.qZA(),e.YNc(71,Ce,2,0,"button",31),e.YNc(72,Fe,2,0,"div",15),e.YNc(73,ye,1,0,"img",32),e.YNc(74,we,3,0,"span",11),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(75,"hr",33),e.TgZ(76,"div",34),e.YNc(77,Ie,3,2,"button",35),e.TgZ(78,"button",36),e.NdJ("click",function(){return n.onCloseModel()}),e._UZ(79,"i",37),e._uU(80),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Oqu(n.title),e.xp6(3),e.Q6J("ngIf",n.loading),e.xp6(3),e.Q6J("formGroup",n.userForm),e.xp6(7),e.Q6J("readonly","detail"===n.action),e.xp6(1),e.Q6J("ngIf",n.userForm.controls.first_name.dirty),e.xp6(7),e.Q6J("readonly","detail"===n.action),e.xp6(1),e.Q6J("ngIf",n.userForm.controls.last_name.dirty),e.xp6(5),e.Q6J("readonly","detail"===n.action),e.xp6(1),e.Q6J("ngIf",n.userForm.controls.department.hasError("required")&&n.userForm.controls.department.touched),e.xp6(5),e.Q6J("readonly","detail"===n.action),e.xp6(1),e.Q6J("ngIf",n.userForm.controls.designation.hasError("required")&&n.userForm.controls.designation.touched),e.xp6(7),e.Q6J("readonly",(null==n.data?null:n.data.id)||"detail"===n.action),e.xp6(1),e.Q6J("ngIf",n.userForm.controls.email.invalid&&n.userForm.controls.email.dirty),e.xp6(10),e.Q6J("readonly","detail"===n.action),e.xp6(1),e.Q6J("ngIf",n.userForm.controls.phone.dirty),e.xp6(1),e.Q6J("ngIf",!n.data),e.xp6(1),e.Q6J("ngIf",n.data),e.xp6(7),e.Q6J("source",n.source)("destination",n.destination)("disabled","detail"===n.action),e.xp6(1),e.Q6J("ngIf",0===(null==n.destination?null:n.destination.length)),e.xp6(4),e.Q6J("src",n.selectedImage?n.selectedImage:"assets/images/default_user.png",e.LSH),e.xp6(2),e.Q6J("ngIf","detail"!==n.action),e.xp6(1),e.Q6J("ngIf",!n.imageToSend),e.xp6(1),e.Q6J("ngIf",n.imageLoading),e.xp6(1),e.Q6J("ngIf",n.notImage),e.xp6(3),e.Q6J("ngIf","detail"!==n.action),e.xp6(3),e.hij(" ","detail"===n.action?"Close":"Discard"," "))},directives:[u.O5,p.xw,p.Wh,a._Y,a.JL,p.yH,a.sg,a.Fj,a.JJ,a.u,a.nD,ee,p.SQ,a.Wl,Z.w9,Z.xv],styles:[".group-container .ng-select-container{box-shadow:none;border-radius:0!important}.loading[_ngcontent-%COMP%]{position:absolute;top:30%;left:43%;z-index:1}"]}),o})();var qe=l(405),Pe=l(3437),Ne=l(5748);function Se(o,s){1&o&&e._UZ(0,"img",28)}function Je(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw().onAddNew()}),e._UZ(1,"i",29),e._uU(2," Add User "),e.qZA()}}function ke(o,s){1&o&&(e.TgZ(0,"th",30),e._uU(1,"ACTION"),e.qZA())}function Qe(o,s){if(1&o&&(e.ynx(0),e.TgZ(1,"span",41),e._uU(2),e.qZA(),e.BQk()),2&o){const t=s.$implicit;e.xp6(2),e.Oqu(t.name)}}function Me(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"a",46),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).$implicit;return e.oxw(2).onAddNew(i)}),e._UZ(1,"i",47),e.qZA()}}function Oe(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"a",48),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).$implicit;return e.oxw(2).onDeleteUser(i)}),e._UZ(1,"i",49),e.qZA()}}function Le(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"a",50),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).$implicit;return e.oxw(2).onResethPassword(i)}),e.TgZ(1,"span",51),e._uU(2,"lock_reset"),e.qZA(),e.qZA()}}function Ye(o,s){if(1&o&&(e.TgZ(0,"td",42),e.YNc(1,Me,2,0,"a",43),e.YNc(2,Oe,2,0,"a",44),e.YNc(3,Le,3,0,"a",45),e.qZA()),2&o){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("ngIf","Blocked"!==t.status),e.xp6(1),e.Q6J("ngIf",n.loggedInUserId!==t.id),e.xp6(1),e.Q6J("ngIf","Blocked"==t.status)}}function Ee(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"tr",32),e.TgZ(1,"td",33),e.TgZ(2,"div",34),e.TgZ(3,"div",35),e._UZ(4,"img",36),e.qZA(),e.TgZ(5,"div",37),e.TgZ(6,"a",38),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).showDetails(r)}),e._uU(7),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"td"),e.YNc(9,Qe,3,1,"ng-container",39),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA(),e.YNc(14,Ye,4,3,"td",40),e.qZA()}if(2&o){const t=s.$implicit,n=s.even,i=e.oxw(2);e.ekj("even-row",n),e.xp6(4),e.Q6J("src",t.user_picture?t.user_picture:"/assets/images/default_user.png",e.LSH),e.xp6(3),e.Oqu(t.first_name+" "+t.last_name),e.xp6(2),e.Q6J("ngForOf",t.selected_groups),e.xp6(2),e.hij(" ",t.email,""),e.xp6(2),e.hij(" ",t.status,""),e.xp6(1),e.Q6J("ngIf",!i.readonly)}}function De(o,s){if(1&o&&(e.ynx(0),e.YNc(1,Ee,15,8,"tr",31),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.users)}}function Be(o,s){1&o&&(e.ynx(0),e.TgZ(1,"tr",52),e._uU(2," No record found "),e.qZA(),e.BQk())}function $e(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"app-pagination",53),e.NdJ("pageChange",function(i){return e.CHM(t),e.oxw().onPageChange(i)}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("length",t.count)}}const Re=[{path:"",component:(()=>{class o{constructor(t,n,i,r,c){this.dialog=t,this.apiService=n,this.toastrService=i,this.router=r,this.checkPermService=c,this.data=[],this.cols=["name","email","status"],this.permission=[],this.showFilters=!1,this.sorting=null,this.search=null,this.slug="",this.loading=!1,this.loggedInUserId=0,this.count=0,this.offset=0,this.limit=10,this.data=[],this.users=[],this.search={search_with:"",search_text:""},this.sorting={column:"",direction:""},this.readonly=!1,this.cols=[{column:"name",title:"Username"},{column:"email",title:"Email"},{column:"status",title:"Status"}]}ngOnDestroy(){this.dialog.dismissAll()}ngOnInit(){let t=localStorage.getItem("user");if(t){let n=JSON.parse(t);this.loggedInUserId=n.id}this.getUsers(),this.checkPermissions()}getUsers(t){this.loading=!0,this.slug=t?`${d.N.userms}/users/?search_with=${t.search_with}&search_text=${t.search_text}&order_by=${t.column}&order=${t.direction}&offset=${this.offset}&limit=${this.limit}`:`${d.N.userms}/users/?offset=${this.offset}&limit=${this.limit}`,this.apiService.get(this.slug).subscribe(n=>{this.loading=!1,this.users=n.data.data,this.count=n.data.count,this.showFilters=!!(t&&"all_columns"!==t.search_with&&t.search_text&&this.users.length>0)},n=>{this.loading=!1,[401,2,3,11,151,153,18,300,301].includes(n.error.status)?this.toastrService.error(n.error.message,"Access Unauthorized",{progressBar:!0,progressAnimation:"decreasing",timeOut:3e3}):this.toastrService.error(n.error.message,"Error",{progressBar:!0,progressAnimation:"decreasing",timeOut:3e3})})}onSort({column:t,direction:n}){this.headers.forEach(i=>{i.sortable!==t&&(i.direction="")}),"asc"===n||"desc"===n?(this.sorting={search_with:this.search.search_with,search_text:this.search.search_text,column:t,direction:n},this.getUsers(this.sorting)):this.getUsers()}checkPermissions(){let t=this.checkPermService.checkPermissions();this.readonly=!(t&&t.length>0&&t.includes("RW"))}onDownload(){const n=this.dialog.open(V.t,{size:"md"});n.componentInstance.slug=this.slug,n.componentInstance.fileName="Users List"}onAddNew(t){const i=this.dialog.open(A,{size:"lg",scrollable:!0});t&&(i.componentInstance.data=t,i.componentInstance.title="Edit User"),i.closed.subscribe(()=>{this.getUsers()})}showDetails(t){const i=this.dialog.open(A,{size:"lg",scrollable:!0});t&&(i.componentInstance.data=t,i.componentInstance.title="User Details",i.componentInstance.action="detail"),i.closed.subscribe(()=>{this.getUsers()})}onResethPassword(t){this.loading=!0,this.apiService.post(`${d.N.userms}/users/reset-password-link`,{id:t.id,link:`${d.N.frontendUrl}/forgot-password`}).subscribe(r=>{this.loading=!1,this.toastrService.info(`Reset password link sent to ${t.email}.`,"Info",{progressBar:!0,progressAnimation:"decreasing",timeOut:4e3})},r=>{this.loading=!1,this.toastrService.error(r.error.message,"Error",{progressAnimation:"decreasing",progressBar:!0,timeOut:3e3})})}onDeleteUser(t){const n=`${d.N.userms}/users/?id=${t.id}`;W.c.confirm("Are you sure?","You want to delete this user?","Yes").subscribe(i=>{i.positive&&(this.loading=!0,this.apiService.delete(n).subscribe(r=>{this.toastrService.info(r.message,"Success",{progressBar:!0,progressAnimation:"decreasing",timeOut:3e3}),this.getUsers()},r=>{this.loading=!1,this.toastrService.error(r.error.message,"Error",{progressBar:!0,progressAnimation:"decreasing",timeOut:3e3})}))})}onSearch(t){this.search={search_with:t.column,search_text:t.search,column:this.sorting.column,direction:this.sorting.direction},""!=t.search?this.getUsers(this.search):this.getUsers()}onPageChange(t){this.offset=t.offset,this.limit=t.pageSize,this.getUsers({search_with:this.search.search_with,search_text:this.search.search_text,column:this.sorting.column,direction:this.sorting.direction})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(m.FF),e.Y36(h.s),e.Y36(x._W),e.Y36(v.F0),e.Y36(qe.$))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-users"]],viewQuery:function(t,n){if(1&t&&e.Gf(U.x,5),2&t){let i;e.iGM(i=e.CRH())&&(n.headers=i)}},decls:36,vars:8,consts:[[1,"card","w-100-p",2,"border","none","height","100%"],[1,"fs-14","fw-600","p-16","pt-10","pb-10","mb-0",2,"border-bottom","1px solid #ececec"],["ngbTooltip","Username, Groups, Email, Status, Action","triggers","mouseenter:mouseleave","container","body","placement","top",1,"ri-information-line","info","grey-400"],["src","/assets/images/block-loader.gif","class","loader","alt","Loading","srcset","","width","150px","height","150px",4,"ngIf"],["fxLayout","row wrap",1,"p-16","w-100-p",2,"height","calc(100% - 40px)"],["fxFlex","100","fxLayout","row","fxLayoutAlign","space-between start",1,"h-48","mb-10"],["fxFlex","60"],["fxFlex","50",3,"cols","showFilters","signal"],["fxLayout","row","fxLayoutAlign","end start","fxFlex","40"],[1,"w-210"],["fxFlex","","class","btn btn-success btn-round fs-14 fw-300","style","border-radius: 20px !important;",3,"click",4,"ngIf"],[1,"col-md-4","pr-0","pl-8"],["fxFlex","",1,"btn","btn-success","btn-round","fs-14","fw-300",2,"border-radius","20px !important",3,"click"],[1,"ri-download-fill"],[1,"w-100-p",2,"height","calc(100% - 58px)"],[2,"display","flex","flex-direction","row","height","auto","max-height","calc(100% - 46px)"],[2,"overflow","auto","flex","1"],["fxFlex",""],[1,"table",2,"width","calc(100% - 1px)"],[2,"position","sticky","top","-1px"],["scope","col","sortable","first_name",2,"position","relative",3,"sort"],["scope","col"],["scope","col","sortable","email",3,"sort"],["scope","col","sortable","status",3,"sort"],["scope","col","class","w-164",4,"ngIf"],[2,"height","calc(100% - 30px)"],[4,"ngIf"],[3,"length","pageChange",4,"ngIf"],["src","/assets/images/block-loader.gif","alt","Loading","srcset","","width","150px","height","150px",1,"loader"],[1,"ri-add-circle-fill"],["scope","col",1,"w-164"],["role","row",3,"even-row",4,"ngFor","ngForOf"],["role","row"],["width","200px","tabindex","0",1,"dtr-control","sorting_1"],[1,"media"],[1,"media-left","pr-10"],["width","30px",1,"img-bordered",3,"src"],[1,"media-body"],[1,"fw-400",2,"text-decoration","underline",3,"click"],[4,"ngFor","ngForOf"],["fxLayoutGap","8px",4,"ngIf"],[1,"grp-chips"],["fxLayoutGap","8px"],["type","button","class","btn btn-icon btn-info btn-xs","ngbTooltip","Edit",3,"click",4,"ngIf"],["type","button","class","btn btn-icon btn-danger btn-xs","ngbTooltip","Delete",3,"click",4,"ngIf"],["type","button","class","btn btn-icon btn-info btn-xs p-0","ngbTooltip","Unblock User",3,"click",4,"ngIf"],["type","button","ngbTooltip","Edit",1,"btn","btn-icon","btn-info","btn-xs",3,"click"],[1,"ri-pencil-fill"],["type","button","ngbTooltip","Delete",1,"btn","btn-icon","btn-danger","btn-xs",3,"click"],[1,"ri-delete-bin-2-fill"],["type","button","ngbTooltip","Unblock User",1,"btn","btn-icon","btn-info","btn-xs","p-0",3,"click"],[1,"material-icons"],["colspan","4"],[3,"length","pageChange"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"h3",1),e._uU(2,"Users "),e._UZ(3,"i",2),e.qZA(),e.YNc(4,Se,1,0,"img",3),e.TgZ(5,"div",4),e.TgZ(6,"div",5),e.TgZ(7,"div",6),e.TgZ(8,"app-search",7),e.NdJ("signal",function(r){return n.onSearch(r)}),e.qZA(),e.qZA(),e.TgZ(9,"div",8),e.TgZ(10,"div",9),e.YNc(11,Je,3,0,"button",10),e.qZA(),e.TgZ(12,"div",11),e.TgZ(13,"button",12),e.NdJ("click",function(){return n.onDownload()}),e._UZ(14,"i",13),e._uU(15," Download "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div",14),e.TgZ(17,"div",15),e.TgZ(18,"div",16),e.TgZ(19,"div",17),e.TgZ(20,"table",18),e.TgZ(21,"thead",19),e.TgZ(22,"tr"),e.TgZ(23,"th",20),e.NdJ("sort",function(r){return n.onSort(r)}),e._uU(24," USERNAME"),e.qZA(),e.TgZ(25,"th",21),e._uU(26,"GROUPS"),e.qZA(),e.TgZ(27,"th",22),e.NdJ("sort",function(r){return n.onSort(r)}),e._uU(28,"EMAIL"),e.qZA(),e.TgZ(29,"th",23),e.NdJ("sort",function(r){return n.onSort(r)}),e._uU(30,"STATUS"),e.qZA(),e.YNc(31,ke,2,0,"th",24),e.qZA(),e.qZA(),e.TgZ(32,"tbody",25),e.YNc(33,De,2,1,"ng-container",26),e.YNc(34,Be,3,0,"ng-container",26),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(35,$e,1,1,"app-pagination",27),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngIf",n.loading),e.xp6(4),e.Q6J("cols",n.cols)("showFilters",n.showFilters),e.xp6(3),e.Q6J("ngIf",!n.readonly),e.xp6(20),e.Q6J("ngIf",!n.readonly),e.xp6(2),e.Q6J("ngIf",!n.loading&&n.users.length>0),e.xp6(1),e.Q6J("ngIf",!n.loading&&0===n.users.length),e.xp6(1),e.Q6J("ngIf",n.users.length>0))},directives:[m._L,u.O5,p.xw,p.yH,p.Wh,Pe.g,U.x,u.sg,p.SQ,Ne.Q],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;width:100%;height:100%;align-content:flex-start;align-items:flex-start}.loader[_ngcontent-%COMP%]{position:absolute;top:32%;left:42%;z-index:1}.info[_ngcontent-%COMP%]{font-weight:400;margin-left:10px}.info[_ngcontent-%COMP%]:hover{text-decoration:underline}.table[_ngcontent-%COMP%]{margin-bottom:0}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#ececec}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{height:30px!important;padding:0 30px 0 4px!important;font-weight:700!important;font-size:12px!important;line-height:28px;position:relative;cursor:pointer}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{padding:4px!important;border:1px solid #e4eaec!important;vertical-align:middle}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none!important;width:28px!important;height:28px!important;line-height:16px!important}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{color:#000}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]   .grp-chips[_ngcontent-%COMP%]{background:#f3f7f9;border-radius:20px;padding:4px 8px;margin-right:2px}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]   .grp-chips[_ngcontent-%COMP%]:hover{background:#e7ecee}.table[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   .asc[_ngcontent-%COMP%]{position:absolute;right:0;padding-right:30px}.table[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]:before{content:"\\2191";opacity:.5;position:absolute;right:8px;top:-2px}.table[_ngcontent-%COMP%]   .asc[_ngcontent-%COMP%]:before{content:"\\2193";opacity:.5;position:absolute;right:2px;top:-2px}.table[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]:after{content:"\\2193";opacity:1;position:absolute;right:2px;top:-2px}.table[_ngcontent-%COMP%]   .asc[_ngcontent-%COMP%]:after{content:"\\2191";opacity:1;position:absolute;right:8px;top:-2px}.table[_ngcontent-%COMP%]   .btn-info[_ngcontent-%COMP%]{background-color:#77d6e1!important;border-color:#77d6e1;color:#fff}.table[_ngcontent-%COMP%]   .btn-info[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{color:#000!important}.table[_ngcontent-%COMP%]   .btn-danger[_ngcontent-%COMP%]{background-color:#f96868!important;border-color:#f96868;color:#fff}.table[_ngcontent-%COMP%]   .btn-danger[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{color:#000!important}.even-row[_ngcontent-%COMP%]{background-color:#f3f7f94d!important}']}),o})(),canActivate:[F.P]},{path:"user-profile",component:H}];let je=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[v.Bz.forChild(Re)]]}),o})();var ze=l(1787),Ge=l(2269),He=l(9785),We=l(9788);let Ve=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[u.ez,a.u5,m.IJ,T.o9]]}),o})();var Xe=l(5651),Ke=l(5297);let et=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[u.ez,a.u5,a.UX,je,m.IJ,T.o9,Z.A0,ze.UserGroupsModule,Ge.B,He.z,We.U,Ve,Xe.o,Ke.t,C.IR]]}),o})()}}]);